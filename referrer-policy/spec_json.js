var SPEC_JSON = {"test_expansion_schema": {"delivery_value": [null, "no-referrer", "no-referrer-when-downgrade", "same-origin", "origin", "origin-when-cross-origin", "strict-origin", "strict-origin-when-cross-origin", "unsafe-url"], "origin": ["same-http", "same-https", "cross-http", "cross-https"], "subresource": ["iframe-tag", "img-tag", "script-tag", "a-tag", "area-tag", "xhr-request", "worker-request", "module-worker", "shared-worker", "fetch-request"], "expansion": ["default", "override"], "source_context": ["req", "top", "srcdoc-inherit", "srcdoc-override", "req-override"], "redirection": ["no-redirect", "keep-origin", "swap-origin"], "referrer_url": ["omitted", "origin", "stripped-referrer"], "delivery_method": ["http-rp", "meta", "attr", "rel-noref"], "source_protocol": ["http", "https"]}, "specification": [{"test_expansion": [{"delivery_value": null, "origin": ["same-http", "cross-http"], "name": "insecure-protocol", "source_protocol": "http", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "stripped-referrer", "source_context": "*", "subresource": "*"}, {"delivery_value": null, "origin": ["same-https", "cross-https"], "name": "upgrade-protocol1", "source_protocol": "http", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "stripped-referrer", "source_context": "*", "subresource": "*"}, {"delivery_value": null, "origin": ["same-http", "cross-http"], "name": "downgrade-protocol", "source_protocol": "https", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "omitted", "source_context": "*", "subresource": "*"}, {"delivery_value": null, "origin": ["same-https", "cross-https"], "name": "secure-protocol", "source_protocol": "https", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "stripped-referrer", "source_context": "*", "subresource": "*"}], "description": "Check that referrer URL follows no-referrer-when-downgrade policy when no explicit Referrer Policy is set.", "specification_url": "https://w3c.github.io/webappsec-referrer-policy/#referrer-policies", "name": "unset-referrer-policy", "title": "Referrer Policy is not explicitly defined"}, {"test_expansion": [{"delivery_value": "no-referrer", "origin": "*", "name": "generic", "source_protocol": "*", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "omitted", "source_context": "*", "subresource": "*"}], "description": "Check that sub-resource never gets the referrer URL.", "specification_url": "https://w3c.github.io/webappsec-referrer-policy/#referrer-policy-no-referrer", "name": "no-referrer", "title": "Referrer Policy is set to 'no-referrer'"}, {"test_expansion": [{"delivery_value": "no-referrer-when-downgrade", "origin": ["same-http", "cross-http"], "name": "insecure-protocol", "source_protocol": "http", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "stripped-referrer", "source_context": "*", "subresource": "*"}, {"delivery_value": "no-referrer-when-downgrade", "origin": ["same-https", "cross-https"], "name": "upgrade-protocol2", "source_protocol": "http", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "stripped-referrer", "source_context": "*", "subresource": "*"}, {"delivery_value": "no-referrer-when-downgrade", "origin": ["same-http", "cross-http"], "name": "downgrade-protocol", "source_protocol": "https", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "omitted", "source_context": "*", "subresource": "*"}, {"delivery_value": "no-referrer-when-downgrade", "origin": ["same-https", "cross-https"], "name": "secure-protocol", "source_protocol": "https", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "stripped-referrer", "source_context": "*", "subresource": "*"}], "description": "Check that non a priori insecure subresource gets the full Referrer URL. A priori insecure subresource gets no referrer information.", "specification_url": "https://w3c.github.io/webappsec-referrer-policy/#referrer-policy-no-referrer-when-downgrade", "name": "no-referrer-when-downgrade", "title": "Referrer Policy is set to 'no-referrer-when-downgrade'"}, {"test_expansion": [{"delivery_value": "origin", "origin": "*", "name": "generic", "source_protocol": "*", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "origin", "source_context": "*", "subresource": "*"}], "description": "Check that all subresources in all casses get only the origin portion of the referrer URL.", "specification_url": "https://w3c.github.io/webappsec-referrer-policy/#referrer-policy-origin", "name": "origin", "title": "Referrer Policy is set to 'origin'"}, {"test_expansion": [{"delivery_value": "same-origin", "origin": "same-http", "name": "same-origin-insecure", "source_protocol": "http", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "stripped-referrer", "source_context": "*", "subresource": "*"}, {"delivery_value": "same-origin", "origin": "same-https", "name": "same-origin-secure-default", "source_protocol": "https", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "stripped-referrer", "source_context": "*", "subresource": "*"}, {"delivery_value": "same-origin", "origin": ["same-http", "same-https"], "name": "same-origin-insecure", "source_protocol": "*", "expansion": "override", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "swap-origin", "referrer_url": "omitted", "source_context": "*", "subresource": "*"}, {"delivery_value": "same-origin", "origin": ["cross-http", "cross-https"], "name": "cross-origin", "source_protocol": "*", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "omitted", "source_context": "*", "subresource": "*"}], "description": "Check that cross-origin subresources get no referrer information and same-origin get the stripped referrer URL.", "specification_url": "https://w3c.github.io/webappsec-referrer-policy/#referrer-policy-same-origin", "name": "same-origin", "title": "Referrer Policy is set to 'same-origin'"}, {"test_expansion": [{"delivery_value": "origin-when-cross-origin", "origin": "same-http", "name": "same-origin-insecure", "source_protocol": "http", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "stripped-referrer", "source_context": "*", "subresource": "*"}, {"delivery_value": "origin-when-cross-origin", "origin": "same-https", "name": "same-origin-secure-default", "source_protocol": "https", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "stripped-referrer", "source_context": "*", "subresource": "*"}, {"delivery_value": "origin-when-cross-origin", "origin": "same-https", "name": "same-origin-upgrade", "source_protocol": "http", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "origin", "source_context": "*", "subresource": "*"}, {"delivery_value": "origin-when-cross-origin", "origin": "same-http", "name": "same-origin-downgrade", "source_protocol": "https", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "origin", "source_context": "*", "subresource": "*"}, {"delivery_value": "origin-when-cross-origin", "origin": ["same-http", "same-https"], "name": "same-origin-insecure", "source_protocol": "*", "expansion": "override", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "swap-origin", "referrer_url": "origin", "source_context": "*", "subresource": "*"}, {"delivery_value": "origin-when-cross-origin", "origin": ["cross-http", "cross-https"], "name": "cross-origin", "source_protocol": "*", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "origin", "source_context": "*", "subresource": "*"}], "description": "Check that cross-origin subresources get the origin portion of the referrer URL and same-origin get the stripped referrer URL.", "specification_url": "https://w3c.github.io/webappsec-referrer-policy/#referrer-policy-origin-when-cross-origin", "name": "origin-when-cross-origin", "title": "Referrer Policy is set to 'origin-when-cross-origin'"}, {"test_expansion": [{"delivery_value": "strict-origin", "origin": ["same-http", "cross-http"], "name": "insecure-protocol", "source_protocol": "http", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "origin", "source_context": "*", "subresource": "*"}, {"delivery_value": "strict-origin", "origin": ["same-https", "cross-https"], "name": "upgrade-protocol3", "source_protocol": "http", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "origin", "source_context": "*", "subresource": "*"}, {"delivery_value": "strict-origin", "origin": ["same-http", "cross-http"], "name": "downgrade-protocol", "source_protocol": "https", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "omitted", "source_context": "*", "subresource": "*"}, {"delivery_value": "strict-origin", "origin": ["same-https", "cross-https"], "name": "secure-protocol", "source_protocol": "https", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "origin", "source_context": "*", "subresource": "*"}], "description": "Check that non a priori insecure subresource gets only the origin portion of the referrer URL. A priori insecure subresource gets no referrer information.", "specification_url": "https://w3c.github.io/webappsec-referrer-policy/#referrer-policy-strict-origin", "name": "strict-origin", "title": "Referrer Policy is set to 'strict-origin'"}, {"test_expansion": [{"delivery_value": "strict-origin-when-cross-origin", "origin": "same-http", "name": "same-insecure", "source_protocol": "http", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "stripped-referrer", "source_context": "*", "subresource": "*"}, {"delivery_value": "strict-origin-when-cross-origin", "origin": "same-http", "name": "same-insecure", "source_protocol": "http", "expansion": "override", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "swap-origin", "referrer_url": "origin", "source_context": "*", "subresource": "*"}, {"delivery_value": "strict-origin-when-cross-origin", "origin": "cross-http", "name": "cross-insecure", "source_protocol": "http", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "origin", "source_context": "*", "subresource": "*"}, {"delivery_value": "strict-origin-when-cross-origin", "origin": ["same-https", "cross-https"], "name": "upgrade-protocol4", "source_protocol": "http", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "origin", "source_context": "*", "subresource": "*"}, {"delivery_value": "strict-origin-when-cross-origin", "origin": ["same-http", "cross-http"], "name": "downgrade-protocol", "source_protocol": "https", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "omitted", "source_context": "*", "subresource": "*"}, {"delivery_value": "strict-origin-when-cross-origin", "origin": "same-https", "name": "same-secure", "source_protocol": "https", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "stripped-referrer", "source_context": "*", "subresource": "*"}, {"delivery_value": "strict-origin-when-cross-origin", "origin": "same-https", "name": "same-secure", "source_protocol": "https", "expansion": "override", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "swap-origin", "referrer_url": "origin", "source_context": "*", "subresource": "*"}, {"delivery_value": "strict-origin-when-cross-origin", "origin": "cross-https", "name": "cross-secure", "source_protocol": "https", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "origin", "source_context": "*", "subresource": "*"}], "description": "Check that a priori insecure subresource gets no referrer information. Otherwise, cross-origin subresources get the origin portion of the referrer URL and same-origin get the stripped referrer URL.", "specification_url": "https://w3c.github.io/webappsec-referrer-policy/#referrer-policy-strict-origin-when-cross-origin", "name": "strict-origin-when-cross-origin", "title": "Referrer Policy is set to 'strict-origin-when-cross-origin'"}, {"test_expansion": [{"delivery_value": "unsafe-url", "origin": "*", "name": "generic", "source_protocol": "*", "expansion": "default", "delivery_method": ["http-rp", "meta", "attr"], "redirection": "*", "referrer_url": "stripped-referrer", "source_context": "*", "subresource": "*"}], "description": "Check that all sub-resources get the stripped referrer URL.", "specification_url": "https://w3c.github.io/webappsec-referrer-policy/#referrer-policy-unsafe-url", "name": "unsafe-url", "title": "Referrer Policy is set to 'unsafe-url'"}], "source_context_schema": {"req-override": {"subresourcePolicyDeliveries": ["policy"], "description": "Policy set by subresource request", "sourceContextList": [{"policyDeliveries": ["anotherPolicy"]}]}, "top": {"subresourcePolicyDeliveries": [], "description": "Policy set by the top-level Document", "sourceContextList": [{"policyDeliveries": ["policy"]}]}, "req": {"subresourcePolicyDeliveries": ["policy"], "description": "Policy set by subresource request", "sourceContextList": [{}]}, "srcdoc-inherit": {"subresourcePolicyDeliveries": [], "description": "srcdoc iframe should inherit parent Document's policy", "sourceContextList": [{"policyDeliveries": ["policy"]}, {"sourceContextType": "srcdoc"}]}, "srcdoc-override": {"subresourcePolicyDeliveries": [], "sourceContextList": [{"policyDeliveries": ["anotherPolicy"]}, {"sourceContextType": "srcdoc", "policyDeliveries": ["policy"]}]}}, "excluded_tests": [{"delivery_value": "*", "origin": ["cross-http", "cross-https"], "name": "cross-origin-workers", "expansion": "*", "source_protocol": "*", "redirection": "*", "referrer_url": "*", "delivery_method": "*", "source_context": "*", "subresource": ["worker-request", "module-worker", "shared-worker"]}, {"delivery_value": "*", "origin": ["same-https", "cross-https"], "name": "upgraded-protocol-workers", "source_protocol": "http", "expansion": "*", "delivery_method": "*", "redirection": "*", "referrer_url": "*", "source_context": "*", "subresource": ["worker-request", "module-worker", "shared-worker"]}, {"delivery_value": "*", "origin": ["same-http", "cross-http"], "name": "mixed-content-insecure-subresources", "source_protocol": "https", "expansion": "*", "delivery_method": "*", "redirection": "*", "referrer_url": "*", "source_context": "*", "subresource": "*"}, {"delivery_value": "*", "origin": "*", "name": "elements-not-supporting-attr-referrer", "source_protocol": "*", "expansion": "*", "delivery_method": ["attr"], "redirection": "*", "referrer_url": "*", "source_context": "*", "subresource": ["xhr-request", "worker-request", "module-worker", "shared-worker", "fetch-request"]}, {"delivery_value": "*", "origin": "*", "name": "elements-not-supporting-rel-noreferrer", "source_protocol": "*", "expansion": "*", "delivery_method": ["rel-noref"], "redirection": "*", "referrer_url": "*", "source_context": "*", "subresource": ["iframe-tag", "img-tag", "script-tag", "xhr-request", "worker-request", "module-worker", "shared-worker", "fetch-request", "area-tag"]}, {"delivery_value": "*", "origin": "*", "name": "area-tag", "source_protocol": "*", "expansion": "*", "delivery_method": "*", "redirection": "*", "referrer_url": "*", "source_context": "*", "subresource": "area-tag"}, {"delivery_value": "*", "origin": "*", "name": "worker-requests-with-swap-origin-redirect", "source_protocol": "*", "expansion": "*", "delivery_method": "*", "redirection": "swap-origin", "referrer_url": "*", "source_context": "*", "subresource": ["worker-request", "module-worker", "shared-worker"]}, {"delivery_value": "*", "origin": "*", "name": "overhead-for-redirection", "source_protocol": "*", "expansion": "*", "delivery_method": "*", "redirection": ["keep-origin", "swap-origin"], "referrer_url": "*", "source_context": "*", "subresource": ["a-tag", "area-tag"]}, {"delivery_value": "*", "origin": "*", "name": "source-https-unsupported-by-web-platform-tests-runners", "source_protocol": "https", "expansion": "*", "delivery_method": "*", "redirection": "*", "referrer_url": "*", "source_context": "*", "subresource": "*"}, {"delivery_value": null, "origin": "*", "name": "source-https-unsupported-by-web-platform-tests-runners-hoge", "source_protocol": "*", "expansion": "*", "delivery_method": "*", "redirection": "*", "referrer_url": "*", "source_context": "srcdoc-override", "subresource": "*"}]};
